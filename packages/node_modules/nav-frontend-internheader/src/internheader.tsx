import * as React from 'react';
import * as PT from 'prop-types';
import * as classnames from 'classnames';
import { Systemtittel, Normaltekst } from 'nav-frontend-typografi';
import LoggUtModal from './LoggUtModal';
import 'nav-frontend-internheader-style';

export interface NavFrontendInternheaderProps {
    /**
     * Egendefinert klassenavn.
     */
    className?: string;

    onProduktTittelClick?: () => void;

    /**
     * Tittel på produkt.
     * F.eks. NAV Kontantstøtte
     */
    produktTittel: string;

    /**
     * Visningsnavn tilknyttet saksbehandler
     */
    saksbehandlerNavn: string;

    /**
     * NAV ident tilknyttet saksbehandler.
     */
    saksbehandlerIdent?: string;

    /**
     * Enhet tilknyttet saksbehandler.
     * F.eks. NAV Sagene
     */
    saksbehandlerEnhet: string;

    /**
     * Tittel tilknyttet saksbehandler.
     * F.eks. veilder
     */
    saksbehandlerTittel: string;

    /**
     * Toggle om man vil bruke logg ut modal
     */
    brukLoggUtModal?: boolean;

    onLoggUtClick?: () => void;
}

interface IState {
    modalIsOpen: boolean;
}

class NavFrontendInternheader extends React.Component<
    NavFrontendInternheaderProps,
    IState
> {
    state = {
        modalIsOpen: false
    };

    render() {
        const {
            brukLoggUtModal,
            className,
            onLoggUtClick,
            onProduktTittelClick,
            produktTittel,
            saksbehandlerEnhet,
            saksbehandlerIdent,
            saksbehandlerNavn,
            saksbehandlerTittel
        } = this.props;
        return (
            <div className={classnames('nav-frontend-internheader', className)}>
                <LoggUtModal
                    setModalIsOpen={(modalIsOpen: boolean) =>
                        this.setState({ modalIsOpen })
                    }
                    modalIsOpen={this.state.modalIsOpen}
                    onLoggUtClick={onLoggUtClick}
                />

                <div className={'nav-frontend-internheader__produkttittel'}>
                    <HeaderKnapp onClick={onProduktTittelClick}>
                        <Systemtittel>{produktTittel}</Systemtittel>
                    </HeaderKnapp>

                    <Divider margin={'0 1rem 0 1rem'} />
                </div>

                <div className={'nav-frontend-internheader__brukermeny'}>
                    <Divider margin={'0 2rem 0 0'} />
                    <div
                        className={
                            'nav-frontend-internheader__brukermeny--saksbehandler'
                        }
                    >
                        <Normaltekst
                            className={
                                'nav-frontend-internheader__brukermeny--saksbehandler-tekst'
                            }
                        >
                            {`${saksbehandlerNavn}${saksbehandlerIdent &&
                                `  ${saksbehandlerIdent}`}`}
                        </Normaltekst>
                        <Normaltekst
                            className={
                                'nav-frontend-internheader__brukermeny--saksbehandler-tekst'
                            }
                        >
                            {`${saksbehandlerEnhet}${saksbehandlerTittel &&
                                `, ${saksbehandlerTittel}`}`}
                        </Normaltekst>
                    </div>

                    <HeaderKnapp
                        onClick={() => {
                            brukLoggUtModal
                                ? this.setState({ modalIsOpen: true })
                                : onLoggUtClick;
                        }}
                    >
                        Logg ut
                    </HeaderKnapp>
                </div>
            </div>
        );
    }
}

const HeaderKnapp: React.StatelessComponent<{
    onClick?: () => void;
    children: React.ReactNode;
}> = ({ children, onClick }) => {
    return (
        <div
            className={'nav-frontend-internheader__knapp'}
            onClick={onClick}
            role={'button'}
        >
            {children}
        </div>
    );
};

const Divider: React.StatelessComponent<{ margin?: string }> = ({ margin }) => {
    return (
        <div
            className={'nav-frontend-internheader__divider'}
            style={{ margin }}
        />
    );
};

(NavFrontendInternheader as React.ComponentClass).propTypes = {
    /**
     * Egendefinert klassenavn.
     */
    className: PT.string,

    produktTittel: PT.string
};

export default NavFrontendInternheader;
